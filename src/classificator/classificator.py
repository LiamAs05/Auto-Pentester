#! /usr/bin/python3
from requests import Response
from bs4 import BeautifulSoup
from src.analyzer.analyzer import Analyzer


POST = 'post'
MIN_INPUTS = 3


username_payloads = [
    'user',
    'name',
    'uname',
    'u-name',
    'username',
    'user-name',
    'mail'
]

passwords_payloads = [
    'password',
    'passwd',
    'pass',
    'pwd',
    'pw'
]


class Classificator:

    @staticmethod
    def is_login_page(response: Response, route: str) -> bool:
        soup = BeautifulSoup(response.text)
        forms = Analyzer.get_forms(soup)

        if not forms:
            return False

        for form in forms:
            if form.attributes.get('action', 'GET').lower() != POST or len(form.inputs) < MIN_INPUTS:
                continue

            for input_form in form.inputs:
                if input_form.attributes.get('action',)







        {"action": "",
         "enctype": "",
         "method": "GET",
         "name": "",
         "rel": "",
         "target": ""}

        {"accept": "",
         "checked": "",
         "disabled": "",
         "form": "",
         "formaction": "",
         "formmethod": "",
         "src": "",
         "type": "",
         "value": ""}
        return True

