from threading import Lock
from src.scan_manager.injector import Injector
from src.scan_manager.scans.IPentester import IPentester
from src.scan_manager.vulnerability import Vulnerability
from src.db_manager.IDBManager import PayloadsTableName


class Element(IPentester):
    def scan(self, vulnerable_list: list[Vulnerability], list_lock: Lock) -> None:
        """
        This function is performs an XSS detection.
        @param vulnerable_list: The global list of vulnerabilities
        @param list_lock: list Mutex
        @return: None
        """
        vulnerabilities_found = Injector.perform_selenium_injection(self._communicator, self._website,
                                                                    self._db_manager,
                                                                    PayloadsTableName.XSS.value,
                                                                    self._mode)
        list_lock.acquire()
        vulnerable_list.extend(vulnerabilities_found)
        list_lock.release()
