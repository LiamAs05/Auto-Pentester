#! /usr/bin/python3
from threading import Lock
from src.db_manager.IDBManager import PayloadsTableName
from src.scan_manager.injector import Injector
from src.scan_manager.scans.IPentester import IPentester
from src.scan_manager.vulnerability import Vulnerability


class Element(IPentester):
    def scan(self, vulnerable_list: list[Vulnerability], list_lock: Lock) -> None:
        responses = Injector.perform_request_injection(self._communicator, self._website,
                                                       self._db_manager, PayloadsTableName.CI.value,
                                                       self._mode)
        print([res.url for res in responses])

